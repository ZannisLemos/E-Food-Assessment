E-Food Mini Assessment

#1
SELECT CITY, COUNT(*) AS TOTAL_ORDERS
FROM `bi-2019-test.ad_hoc.orders_jan2021`
WHERE CUISINE_PARENT = "Breakfast" AND CITY IN (SELECT CITY FROM `bi-2019-test.ad_hoc.orders_jan2021` 
GROUP BY CITY 
HAVING COUNT(ORDER_ID)>500)
GROUP BY CITY
ORDER BY COUNT(*) DESC
LIMIT 10;

#2
SELECT CITY, COUNT(DISTINCT USER_ID) AS USERS
FROM `bi-2019-test.ad_hoc.orders_jan2021`
WHERE CUISINE_PARENT = "Breakfast" AND CITY IN (SELECT CITY FROM `bi-2019-test.ad_hoc.orders_jan2021` 
GROUP BY CITY 
HAVING COUNT(ORDER_ID)>500)
GROUP BY CITY
ORDER BY COUNT(*) DESC
LIMIT 10;

#3
SELECT USER_ID, ROUND(AVG(BASKET),2) AS AVERAGE_BASKET
FROM `bi-2019-test.ad_hoc.orders_jan2021`
WHERE CITY IN (SELECT CITY FROM `bi-2019-test.ad_hoc.orders_jan2021` 
GROUP BY CITY 
HAVING COUNT(ORDER_ID)>500) AND USER_ID IN(SELECT DISTINCT USER_ID 
FROM `bi-2019-test.ad_hoc.orders_jan2021`
WHERE CUISINE_PARENT = "Breakfast" AND CITY IN (SELECT CITY FROM `bi-2019-test.ad_hoc.orders_jan2021` 
GROUP BY CITY 
HAVING COUNT(ORDER_ID)>500))
GROUP BY USER_ID
ORDER BY AVERAGE_BASKET DESC
LIMIT 10;
